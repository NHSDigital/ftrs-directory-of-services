{
  "Version": "2012-10-17",
  "Statement": [
      {
          "Sid": "SecurityHubAllowAll",
          "Effect": "Allow",
          "Action": "securityhub:*",
          "Resource": "*"
      },
      {
          "Sid": "SecurityHubServiceLinkedRole",
          "Effect": "Allow",
          "Action": "iam:CreateServiceLinkedRole",
          "Resource": "*",
          "Condition": {
              "StringLike": {
                  "iam:AWSServiceName": "securityhub.amazonaws.com"
              }
          }
      },
      {
          "Sid": "OtherServicePermission",
          "Effect": "Allow",
          "Action": [
              "guardduty:GetDetector",
              "guardduty:ListDetectors",
              "inspector2:BatchGetAccountStatus",
              "pricing:GetProducts"
          ],
          "Resource": "*"
      },
      {
        "Sid": "AmazonGuardDutyFullAccessSid1",
        "Effect": "Allow",
        "Action": "guardduty:*",
        "Resource": "*"
    },
    {
        "Sid": "CreateServiceLinkedRoleSid1",
        "Effect": "Allow",
        "Action": "iam:CreateServiceLinkedRole",
        "Resource": "*",
        "Condition": {
            "StringLike": {
                "iam:AWSServiceName": [
                    "guardduty.amazonaws.com",
                    "malware-protection.guardduty.amazonaws.com"
                ]
            }
        }
    },
    {
        "Sid": "ActionsForOrganizationsSid1",
        "Effect": "Allow",
        "Action": [
            "organizations:EnableAWSServiceAccess",
            "organizations:RegisterDelegatedAdministrator",
            "organizations:ListDelegatedAdministrators",
            "organizations:ListAWSServiceAccessForOrganization",
            "organizations:DescribeOrganizationalUnit",
            "organizations:DescribeAccount",
            "organizations:DescribeOrganization",
            "organizations:ListAccounts"
        ],
        "Resource": "*"
    },
    {
        "Sid": "IamGetRoleSid1",
        "Effect": "Allow",
        "Action": "iam:GetRole",
        "Resource": "arn:aws:iam::*:role/*AWSServiceRoleForAmazonGuardDutyMalwareProtection"
    },
    {
        "Sid": "AllowPassRoleToMalwareProtectionPlan",
        "Effect": "Allow",
        "Action": [
            "iam:PassRole"
        ],
        "Resource": "arn:aws:iam::*:role/*",
        "Condition": {
            "StringEquals": {
                "iam:PassedToService": "malware-protection-plan.guardduty.amazonaws.com"
            }
        }
    },
    {
      "Sid": "AllowFullAccessToInspectorApis",
      "Effect": "Allow",
      "Action": "inspector2:*",
      "Resource": "*"
  },
  {
      "Sid": "AllowAccessToCodeGuruApis",
      "Effect": "Allow",
      "Action": [
          "codeguru-security:BatchGetFindings",
          "codeguru-security:GetAccountConfiguration"
      ],
      "Resource": "*"
  },
  {
      "Sid": "AllowAccessToCreateSlr",
      "Effect": "Allow",
      "Action": "iam:CreateServiceLinkedRole",
      "Resource": "*",
      "Condition": {
          "StringEquals": {
              "iam:AWSServiceName": [
                  "agentless.inspector2.amazonaws.com",
                  "inspector2.amazonaws.com"
              ]
          }
      }
  },
  {
      "Sid": "AllowAccessToOrganizationApis",
      "Effect": "Allow",
      "Action": [
          "organizations:EnableAWSServiceAccess",
          "organizations:RegisterDelegatedAdministrator",
          "organizations:ListDelegatedAdministrators",
          "organizations:ListAWSServiceAccessForOrganization",
          "organizations:DescribeOrganizationalUnit",
          "organizations:DescribeAccount",
          "organizations:DescribeOrganization"
      ],
      "Resource": "*"
  },
  {
    "Effect": "Allow",
    "Action": [
        "acm:*"
    ],
    "Resource": "*"
},
{
    "Effect": "Allow",
    "Action": "iam:CreateServiceLinkedRole",
    "Resource": "arn:aws:iam::*:role/aws-service-role/acm.amazonaws.com/AWSServiceRoleForCertificateManager*",
    "Condition": {
        "StringEquals": {
            "iam:AWSServiceName": "acm.amazonaws.com"
        }
    }
},
{
    "Effect": "Allow",
    "Action": [
        "iam:DeleteServiceLinkedRole",
        "iam:GetServiceLinkedRoleDeletionStatus",
        "iam:GetRole"
    ],
    "Resource": "arn:aws:iam::*:role/aws-service-role/acm.amazonaws.com/AWSServiceRoleForCertificateManager*"
}
  ]
}
