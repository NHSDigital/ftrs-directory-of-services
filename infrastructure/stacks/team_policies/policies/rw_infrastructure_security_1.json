{
  "Version": "2012-10-17",
  "Statement": [
      {
          "Effect": "Allow",
          "Action": [
              "sns:AddPermission",
              "sns:CreateTopic",
              "sns:SetTopicAttributes",
              "sns:GetTopicAttributes"
          ],
          "Resource": [
              "arn:aws:sns:*:*:aws-cloudtrail-logs*"
          ]
      },
      {
          "Effect": "Allow",
          "Action": [
              "sns:ListTopics"
          ],
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": [
              "s3:CreateBucket",
              "s3:PutBucketPolicy",
              "s3:PutBucketPublicAccessBlock"
          ],
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": [
              "s3:ListAllMyBuckets",
              "s3:GetBucketLocation",
              "s3:GetBucketPolicy"
          ],
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": "cloudtrail:*",
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": [
              "logs:CreateLogGroup"
          ],
          "Resource": [
              "arn:aws:logs:*:*:log-group:aws-cloudtrail-logs*"
          ]
      },
      {
          "Effect": "Allow",
          "Action": [
              "iam:ListRoles",
              "iam:GetRolePolicy",
              "iam:GetUser"
          ],
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": [
              "iam:PassRole"
          ],
          "Resource": "*",
          "Condition": {
              "StringEquals": {
                  "iam:PassedToService": "cloudtrail.amazonaws.com"
              }
          }
      },
      {
          "Effect": "Allow",
          "Action": [
              "kms:CreateKey",
              "kms:CreateAlias",
              "kms:ListKeys",
              "kms:ListAliases"
          ],
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": [
              "lambda:ListFunctions"
          ],
          "Resource": "*"
      },
      {
          "Effect": "Allow",
          "Action": [
              "dynamodb:ListGlobalTables",
              "dynamodb:ListTables"
          ],
          "Resource": "*"
      },
      {
        "Effect": "Allow",
        "Action": [
            "kms:CreateAlias",
            "kms:CreateKey",
            "kms:DeleteAlias",
            "kms:Describe*",
            "kms:GenerateRandom",
            "kms:Get*",
            "kms:List*",
            "kms:TagResource",
            "kms:UntagResource",
            "iam:ListGroups",
            "iam:ListRoles",
            "iam:ListUsers"
        ],
        "Resource": "*"
    },
    {
      "Version":"2012-10-17",
      "Statement": [
        {
          "Sid": "IAMPermissions",
          "Effect": "Allow",
          "Action": [
              "iam:GenerateCredentialReport",
              "iam:List*",
              "iam:GenerateServiceLastAccessedDetails",
              "iam:TagRole",
              "iam:DeletePolicy",
              "iam:CreateRole",
              "iam:DeleteRole",
              "iam:AttachRolePolicy",
              "iam:TagPolicy",
              "iam:CreatePolicy",
              "iam:PassRole",
              "iam:Get*",
              "iam:DetachRolePolicy",
              "iam:SimulatePrincipalPolicy",
              "iam:SimulateCustomPolicy",
              "iam:CreatePolicyVersion",
              "iam:DeletePolicyVersion",
              "iam:TagOpenIDConnectProvider",
              "iam:DeleteRolePolicy",
              "iam:PutRolePolicy",
              "iam:UpdateOpenIDConnectProviderThumbprint",
              "iam:UntagPolicy",
              "iam:UntagRole"
          ],
          "Resource": "*"
        }
      ]
    }
  ]
}
